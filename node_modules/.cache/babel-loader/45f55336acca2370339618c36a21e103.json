{"ast":null,"code":"import \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport _classCallCheck from \"/Users/linjiajun/Desktop/htdoc/web/react-desktops/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/linjiajun/Desktop/htdoc/web/react-desktops/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/linjiajun/Desktop/htdoc/web/react-desktops/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/linjiajun/Desktop/htdoc/web/react-desktops/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/linjiajun/Desktop/htdoc/web/react-desktops/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/linjiajun/Desktop/htdoc/web/react-desktops/src/components/file/File.js\";\nimport React, { Component } from 'react';\nimport { calc_empty_list } from \"../../public/utils/com\";\nimport { file_logo } from \"../../public/utils/file_logo\";\n\nvar File =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(File, _Component);\n\n  function File() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, File);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(File)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.onWindowResize = function () {\n      var list = calc_empty_list(_this.files_list.offsetWidth, 90, _this.props.fileLists.length, _this.props.emptyLists.length);\n\n      if (list) {\n        _this.props.emptyList(list);\n      }\n    };\n\n    _this.domdrugstart = function (sort, name, imgUrl, ee) {\n      ee.dataTransfer.setData(\"name\", name);\n      ee.dataTransfer.setData(\"sort\", sort);\n    };\n\n    _this.dragenter = function (ee) {} // ee.currentTarget.style.border = '2px dashed #008dff';\n    // ee.currentTarget.style.boxShadow = '0 0 8px rgba(30, 144, 255, 0.8)';\n    // a拖到b，离开b的时候触发\n    ;\n\n    _this.dragleave = function (ee) {} // ee.currentTarget.style.border = ''\n    // ee.currentTarget.style.boxShadow = ''\n    // 对象排序\n    ;\n\n    _this.drop = function (dropedSort, data, sortKey, ee) {\n      ee.preventDefault();\n      var name = ee.dataTransfer.getData(\"name\");\n      var sort = ee.dataTransfer.getData(\"sort\"); // if (sort < dropedSort) {\n\n      data.map(function (item) {\n        if (item.name === name) {\n          item[sortKey] = dropedSort;\n        } else if (item[sortKey] > sort && item[sortKey] < dropedSort + 1) {\n          item[sortKey]--;\n        }\n\n        return item;\n      }); // } else {\n      //   data.map(item => {\n      //     if (item.imgUrl === imgUrl) {\n      //       item[sortKey] = dropedSort;\n      //     } else if (item[sortKey] > dropedSort - 1 && item[sortKey] < sort) {\n      //       item[sortKey]++;\n      //     }\n      //     return item;\n      //   });\n      // }\n\n      _this.props.setFileList(data);\n    };\n\n    _this.allowDrop = function (ee) {\n      ee.preventDefault();\n    };\n\n    return _this;\n  }\n\n  _createClass(File, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.onWindowResize();\n      window.addEventListener('resize', this.onWindowResize);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.onWindowResize);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        ref: function ref(files_list) {\n          _this2.files_list = files_list;\n        },\n        className: \"findder_files_list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 16\n        },\n        __self: this\n      }, this.props.fileLists.sort(this.compare('sort')).map(function (row) {\n        return React.createElement(\"div\", {\n          key: row.name,\n          className: \"finder_file\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 21\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"file\",\n          onDragEnter: _this2.dragenter,\n          onDragLeave: _this2.dragleave,\n          onDragStart: function onDragStart(el) {\n            _this2.domdrugstart(row.sort, row.name, row.imgUrl, el);\n          },\n          onDrop: function onDrop(el) {\n            _this2.drop(row.sort, _this2.props.fileLists, 'sort', el);\n          },\n          onDragOver: _this2.allowDrop,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 25\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: file_logo(row.type),\n          alt: row.name,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 33\n          },\n          __self: this\n        }), React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 34\n          },\n          __self: this\n        }, row.name)));\n      }), this.props.emptyLists, React.createElement(_Button, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }, \"asd\"));\n    } //监听窗口大小\n\n  }, {\n    key: \"compare\",\n    value: function compare(key) {\n      return function (obj1, obj2) {\n        if (obj1[key] < obj2[key]) {\n          return -1;\n        } else if (obj1[key] > obj2[key]) {\n          return 1;\n        }\n\n        return 0;\n      };\n    } // 当一个元素或是选中的文字被拖拽释放到一个有效的释放目标位置时\n\n  }]);\n\n  return File;\n}(Component);\n\nexport default File;","map":{"version":3,"sources":["/Users/linjiajun/Desktop/htdoc/web/react-desktops/src/components/file/File.js"],"names":["React","Component","calc_empty_list","file_logo","File","onWindowResize","list","files_list","offsetWidth","props","fileLists","length","emptyLists","emptyList","domdrugstart","sort","name","imgUrl","ee","dataTransfer","setData","dragenter","dragleave","drop","dropedSort","data","sortKey","preventDefault","getData","map","item","setFileList","allowDrop","window","addEventListener","removeEventListener","compare","row","el","type","key","obj1","obj2"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\nimport { Button } from \"antd\"\nimport {calc_empty_list} from \"../../public/utils/com\";\nimport {file_logo} from \"../../public/utils/file_logo\";\n\nclass File extends Component {\n  componentDidMount(){\n    this.onWindowResize()\n    window.addEventListener('resize', this.onWindowResize)\n  }\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.onWindowResize)\n  }\n  render() {\n    return (\n      <div\n        ref={(files_list)=>{this.files_list=files_list}}\n        className=\"findder_files_list\"\n      >\n        {this.props.fileLists.sort(this.compare('sort')).map((row)=>(\n          <div\n            key={row.name}\n            className=\"finder_file\"\n          >\n            <div\n              className=\"file\"\n              onDragEnter={this.dragenter}\n              onDragLeave={this.dragleave}\n              onDragStart={(el)=>{this.domdrugstart( row.sort, row.name, row.imgUrl, el)}}\n              onDrop={(el)=>{this.drop(row.sort, this.props.fileLists, 'sort', el)}}\n              onDragOver={this.allowDrop}\n            >\n              <img src={file_logo(row.type)} alt={row.name}/>\n              <span>{row.name}</span>\n            </div>\n\n          </div>\n        ))}\n        {this.props.emptyLists}\n        <Button>asd</Button>\n      </div>\n    )\n  }\n  //监听窗口大小\n  onWindowResize = () => {\n    const list = calc_empty_list(this.files_list.offsetWidth,90,this.props.fileLists.length,this.props.emptyLists.length)\n    if(list){\n      this.props.emptyList(list)\n    }\n  }\n  // 拖动事件\n  domdrugstart = (sort, name, imgUrl, ee) => {\n    ee.dataTransfer.setData(\"name\", name)\n    ee.dataTransfer.setData(\"sort\", sort)\n  }\n  // 拖动后鼠标进入另一个可接受区域\n  dragenter = (ee) => {\n    // ee.currentTarget.style.border = '2px dashed #008dff';\n    // ee.currentTarget.style.boxShadow = '0 0 8px rgba(30, 144, 255, 0.8)';\n  }\n  // a拖到b，离开b的时候触发\n  dragleave = (ee) => {\n    // ee.currentTarget.style.border = ''\n    // ee.currentTarget.style.boxShadow = ''\n  }\n  // 对象排序\n  compare(key) {\n    return (obj1, obj2) => {\n      if (obj1[key] < obj2[key]) {\n        return -1;\n      } else if (obj1[key] > obj2[key]) {\n        return 1;\n      }\n      return 0\n    }\n  }\n  // 当一个元素或是选中的文字被拖拽释放到一个有效的释放目标位置时\n  drop = (dropedSort, data, sortKey, ee) => {\n    ee.preventDefault();\n    const name = ee.dataTransfer.getData(\"name\");\n    const sort = ee.dataTransfer.getData(\"sort\");\n    // if (sort < dropedSort) {\n      data.map(item => {\n        if (item.name === name) {\n          item[sortKey] = dropedSort;\n        } else if (item[sortKey] > sort && item[sortKey] < dropedSort + 1) {\n          item[sortKey]--;\n        }\n        return item;\n      })\n    // } else {\n    //   data.map(item => {\n    //     if (item.imgUrl === imgUrl) {\n    //       item[sortKey] = dropedSort;\n    //     } else if (item[sortKey] > dropedSort - 1 && item[sortKey] < sort) {\n    //       item[sortKey]++;\n    //     }\n    //     return item;\n    //   });\n    // }\n    this.props.setFileList(data)\n  }\n  allowDrop = (ee) => {\n    ee.preventDefault();\n  }\n}\n\n\nexport default File"]},"metadata":{},"sourceType":"module"}